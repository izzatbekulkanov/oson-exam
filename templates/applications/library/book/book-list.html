{% extends 'base.html' %}

{% load static %}
{% load sass_tags %}
{% load i18n %}

{% block css %}
    <!-- Plugins css start-->
    <link rel="stylesheet" type="text/css" href="{% sass_src 'assets/scss/vendors/select2.scss' %}">
    <link rel="stylesheet" type="text/css" href="{% sass_src 'assets/scss/vendors/owlcarousel.scss' %}">
    <link rel="stylesheet" type="text/css" href="{% sass_src 'assets/scss/vendors/range-slider.scss' %}">
    <!-- Plugins css Ends-->
{% endblock %}

{% block content %}

    <div class="page-body">
        <div class="container-fluid product-wrapper">
            {% include "layout/breadcrumb.html" %}


            {% include "applications/library/book/components/filters.html" %}
            {% include "applications/library/book/components/book-1.html" %}


        </div>
    </div>

{% endblock %}

{% block scriptcontent %}

    <script>
        function fetchBookTypes() {
            $.ajax({
                url: '{% url "get_book_types" %}',
                method: 'GET',
                success: function (response) {
                    var bookTypes = response.book_types;
                    var container = $('#book-type-container');
                    container.empty();


                    bookTypes.forEach(function (bookType) {
                        var bookTypeHTML = `
                            <div class="col-xl-2 col-sm-6 xl-4">
                                <div class="card">
                                    <div class="product-box">
                                        <div class="product-img">
                                            <div class="ribbon ribbon-success">Yangi</div>
                                            <img class="img-fluid" src="${bookType.image ? bookType.image : '{% static 'assets/images/default/book-type-cover.jpg' %}'}">
                                            <div class="product-hover">
                                                <ul>
                                                    <li>
                                                        <a class="btn" type="button" href="${createBBKListURL(bookType.id)}"><i class="icon-eye"></i></a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="product-details">
                                            <h4>${bookType.name}</h4>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
                        container.append(bookTypeHTML);
                    });
                },
                error: function (error) {
                    console.log('Error fetching book types:', error);
                }
            });
        }

        function createBBKListURL(bookTypeId) {
            var baseUrl = '{% url "book_bbk_list" %}';
            return `${baseUrl}?type=${bookTypeId}`;
        }

        // Funksiyani chaqirish uchun
        $(document).ready(function () {
            fetchBookTypes();
        });
    </script>

    <!-- Plugins JS start-->
    <script src="{% static 'assets/js/range-slider/ion.rangeSlider.min.js' %}"></script>
    <script src="{% static 'assets/js/range-slider/rangeslider-script.js' %}"></script>
    <script src="{% static 'assets/js/touchspin/vendors.min.js' %}"></script>
    <script src="{% static 'assets/js/touchspin/touchspin.js' %}"></script>
    <script src="{% static 'assets/js/touchspin/input-groups.min.js' %}"></script>
    <script src="{% static 'assets/js/owlcarousel/owl.carousel.js' %}"></script>
    <script src="{% static 'assets/js/select2/select2.full.min.js' %}"></script>
    <script src="{% static 'assets/js/select2/select2-custom.js' %}"></script>
    <script src="{% static 'assets/js/tooltip-init.js' %}"></script>
    <script src="{% static 'assets/js/product-tab.js' %}"></script>
    <!-- Plugins JS Ends-->
{% endblock %}